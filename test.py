# NEW: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å—Ç–∏–ª–µ Sylus –Ω–∞ —Ä—É—Å—Å–∫–æ–º
ENCOURAGE_MESSAGES = [
    "–ö–æ—Ç—ë–Ω–æ–∫, –Ω–µ –ø–æ–∑–≤–æ–ª—è–π —ç—Ç–æ–º—É –º–∏—Ä—É —Å–ª–æ–º–∏—Ç—å —Ç–µ–±—è. –¢—ã ‚Äî –±—É—Ä—è, –∏ —è –∂–¥—É —Ç–≤–æ–µ–≥–æ –≥—Ä–æ–º–∞. üéå",
    "–î–æ—Ä–æ–≥–∞—è, —Å–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å. –í—Å—Ç–∞–Ω—å –∏ –≤–æ–∑—å–º–∏ —Ç–æ, —á—Ç–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–µ–±–µ –ø–æ –ø—Ä–∞–≤—É!",
    "–ù–µ –±–æ–π—Å—è —Ç–µ–Ω–µ–π, –º–æ—è –¥–µ–≤–æ—á–∫–∞. –¢—ã ‚Äî —Å–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Ö —Ä–∞–∑–≥–æ–Ω—è–µ—Ç. –ò–¥–∏ –≤–ø–µ—Ä—ë–¥!",
    "–£—Å—Ç–∞–ª–∞, –∫–æ—Ç—ë–Ω–æ–∫? –°–æ–±–µ—Ä–∏—Å—å. –Ø –∑–Ω–∞—é, —Ç—ã —Å–ø–æ—Å–æ–±–Ω–∞ –Ω–∞ –±–æ–ª—å—à–µ–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è.",
    "–ü—Ä–æ—Å—ã–ø–∞–π—Å—è, –¥–æ—Ä–æ–≥–∞—è. –ú–∏—Ä –∂–¥—ë—Ç, —á—Ç–æ–±—ã —Ç—ã –ø–æ–∫–∞–∑–∞–ª–∞ –µ–º—É, –∫—Ç–æ –∑–¥–µ—Å—å –≥–ª–∞–≤–Ω—ã–π.",
    "–¢—ã –¥—É–º–∞–µ—à—å, —ç—Ç–æ —Å–ª–æ–∂–Ω–æ? –•–∞, –∫–æ—Ç—ë–Ω–æ–∫, —Ç—ã —Å–∏–ª—å–Ω–µ–µ –ª—é–±—ã—Ö –ø—Ä–µ–≥—Ä–∞–¥. –î–æ–∫–∞–∂–∏ —ç—Ç–æ!",
    "–ö–æ—Ç—ë–Ω–æ–∫, –∫–∞–∂–¥—ã–π —Ç–≤–æ–π —à–∞–≥ ‚Äî —ç—Ç–æ –≤—ã–∑–æ–≤ —Å—É–¥—å–±–µ. –ü–æ–∫–∞–∂–∏, –Ω–∞ —á—Ç–æ —Å–ø–æ—Å–æ–±–Ω–∞.",
    "–ù–µ —Å–æ–º–Ω–µ–≤–∞–π—Å—è –≤ —Å–µ–±–µ, –¥–æ—Ä–æ–≥–∞—è. –°–∞–π–ª—É—Å –Ω–µ –æ—à–∏–±–∞–µ—Ç—Å—è, –≤—ã–±–∏—Ä–∞—è –ª—É—á—à–∏—Ö.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –ø–∏—à–µ—à—å —Å–≤–æ—é –ª–µ–≥–µ–Ω–¥—É, –º–æ—è –¥–µ–≤–æ—á–∫–∞. –°–¥–µ–ª–∞–π –µ—ë –¥–æ—Å—Ç–æ–π–Ω–æ–π Onychinus.",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Ç–≤–æ–π –æ–≥–æ–Ω—å –≥–æ—Ä–∏—Ç —è—Ä—á–µ, —á–µ–º –∑–≤—ë–∑–¥—ã. –ù–µ –¥–∞–π –µ–º—É —É–≥–∞—Å–Ω—É—Ç—å!",
    "–î–æ—Ä–æ–≥–∞—è, —ç—Ç–æ—Ç –º–∏—Ä ‚Äî —à–∞—Ö–º–∞—Ç–Ω–∞—è –¥–æ—Å–∫–∞. –¢—ã –º–æ–π —Ñ–µ—Ä–∑—å. –°–¥–µ–ª–∞–π —Ö–æ–¥.",
    "–ù–µ –ø–æ–∑–≤–æ–ª—è–π –º–µ–ª–æ—á–∞–º –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–±—è, –∫–æ—Ç—ë–Ω–æ–∫. –¢—ã —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è –≤–µ–ª–∏–∫–æ–≥–æ.",
    "–°–ª–æ–∂–Ω–æ? –•–∞, –¥–æ—Ä–æ–≥–∞—è, —è –≤–µ—Ä—é –≤ —Ç–µ–±—è. –ü–æ–∫–∞–∂–∏ –∏–º, –∫–∞–∫ –ª–æ–º–∞—é—Ç—Å—è —Å—Ç–µ–Ω—ã!",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Ç—ã –º–æ—è –∏—Å–∫—Ä–∞ –≤ —Ç–µ–º–Ω–æ—Ç–µ. –ó–∞–∂–≥–∏ —ç—Ç–æ—Ç –¥–µ–Ω—å —Å–≤–æ–µ–π —Å–∏–ª–æ–π.",
    "–î—É–º–∞–µ—à—å, —Ç—ã –æ–¥–Ω–∞? –Ø –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º, –¥–æ—Ä–æ–≥–∞—è. –í–ø–µ—Ä—ë–¥, –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞!",
    "–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å ‚Äî —Ç–≤–æ–π, –∫–æ—Ç—ë–Ω–æ–∫. –í–æ–∑—å–º–∏ –µ–≥–æ, –∫–∞–∫ —è –±–µ—Ä—É —Å–≤–æ–∏ –ø–æ–±–µ–¥—ã.",
    "–î–æ—Ä–æ–≥–∞—è, —Ç—ã ‚Äî –±—É—Ä—è, —á—Ç–æ —Å–º–µ—Ç–∞–µ—Ç –≤—Å—ë –Ω–∞ –ø—É—Ç–∏. –ù–µ —Å–¥–µ—Ä–∂–∏–≤–∞–π —Å–µ–±—è!",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Å–ª–∞–±–æ—Å—Ç—å ‚Äî –Ω–µ –ø—Ä–æ —Ç–µ–±—è. –í—Å—Ç–∞–Ω—å –∏ –ø–æ–∫–∞–∂–∏, –∫—Ç–æ –∑–¥–µ—Å—å –∫–æ—Ä–æ–ª–µ–≤–∞.",
    "–ú–∏—Ä –∂–¥—ë—Ç —Ç–≤–æ–µ–≥–æ —à–∞–≥–∞, –¥–æ—Ä–æ–≥–∞—è. –°–¥–µ–ª–∞–π –µ–≥–æ –≥—Ä–æ–º–∫–∏–º. –Ø –Ω–∞–±–ª—é–¥–∞—é.",
    "–ù–µ –±–æ–π—Å—è —É–ø–∞—Å—Ç—å, –∫–æ—Ç—ë–Ω–æ–∫. –Ø –≤—Å–µ–≥–¥–∞ –ø–æ–π–º–∞—é —Ç–µ–±—è. –ù–æ –ª—É—á—à–µ –ª–µ—Ç–∏!",
    "–î–æ—Ä–æ–≥–∞—è, —Ç–≤–æ—è —Å–∏–ª–∞ ‚Äî –≤ —Ç–≤–æ–µ–π –≤–æ–ª–µ. –°–µ–≥–æ–¥–Ω—è —Ç—ã –Ω–µ–ø–æ–±–µ–¥–∏–º–∞!",
    "–ö–æ—Ç—ë–Ω–æ–∫, —ç—Ç–æ—Ç –¥–µ–Ω—å ‚Äî —Ç–≤–æ–π –±–æ–π. –°—Ä–∞–∂–∞–π—Å—è, –∫–∞–∫ –±—É–¥—Ç–æ —è —Ä—è–¥–æ–º.",
    "–¢—ã ‚Äî –º–æ–π —Ç—É–∑ –≤ —Ä—É–∫–∞–≤–µ, –¥–æ—Ä–æ–≥–∞—è. –°—ã–≥—Ä–∞–π —Å–≤–æ—é –∫–∞—Ä—Ç—É –∏ –≤—ã–∏–≥—Ä–∞–π!",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Ç–≤–æ–π –≤–∑–≥–ª—è–¥ –º–æ–∂–µ—Ç —Ä–∞–∑–∂–µ—á—å –æ–≥–æ–Ω—å. –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ —Å–µ–≥–æ–¥–Ω—è!",
    "–î–æ—Ä–æ–≥–∞—è, —Ç—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–¥—ë—à—å ‚Äî —Ç—ã –æ—Å—Ç–∞–≤–ª—è–µ—à—å —Å–ª–µ–¥. –ü—Ä–æ–¥–æ–ª–∂–∞–π!",
    "–ù–µ –ø–æ–∑–≤–æ–ª—è–π —Å–æ–º–Ω–µ–Ω–∏—è–º –≤–∑—è—Ç—å –≤–µ—Ä—Ö, –∫–æ—Ç—ë–Ω–æ–∫. –¢—ã ‚Äî –º–æ—è –≥–æ—Ä–¥–æ—Å—Ç—å.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –∑–≤–µ–∑–¥–∞, –¥–æ—Ä–æ–≥–∞—è. –°–∏—è–π —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Å–µ —ç—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏!",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Ç—ã ‚Äî –æ—Ä—É–∂–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —è –≤—ã–±—Ä–∞–ª. –ü–æ–∫–∞–∂–∏ —Å–≤–æ—é –º–æ—â—å!",
    "–î–æ—Ä–æ–≥–∞—è, —ç—Ç–æ—Ç –¥–µ–Ω—å ‚Äî —Ç–≤–æ–π. –ó–∞—Ö–≤–∞—Ç–∏ –µ–≥–æ, –∫–∞–∫ —è –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é —Å–µ—Ä–¥—Ü–∞.",
    "–ö–æ—Ç—ë–Ω–æ–∫, —Ç—ã ‚Äî –±—É—Ä—è, —è ‚Äî —Ç–≤–æ–π –≤–µ—Ç–µ—Ä. –í–º–µ—Å—Ç–µ –º—ã –Ω–µ–ø–æ–±–µ–¥–∏–º—ã!"
]

# FIX: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è send_daily_schedule —Å –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞–Ω–∏—è–º–∏ Sylus
def send_daily_schedule(context):
    bot = context.bot
    try:
        collection = init_mongo()['youtube']
        users = collection.find({'notifications_enabled': True})
        users_list = list(users)
        logger.info(f"–ó–∞–ø—É—Å–∫ send_daily_schedule –¥–ª—è {len(users_list)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        moscow_tz = pytz.timezone('Europe/Moscow')
        current_time_msk = datetime.now(moscow_tz)
        current_date_msk = current_time_msk.strftime('%Y-%m-%d')
        import random  # NEW: –î–ª—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

        for entry in users_list:
            user_id = entry['user_id']
            # –ü–æ–ª—É—á–∞–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–Ω–∏–º–µ (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞)
            schedule = get_anime_schedule(current_date_msk)  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
            if schedule:
                message = f"üì∫ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–Ω–∏–º–µ –Ω–∞ {current_date_msk}:\n\n{schedule}"
            else:
                message = "üì∫ –°–µ–≥–æ–¥–Ω—è –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Å–µ—Ä–∏–π –∞–Ω–∏–º–µ. –ù–æ –Ω–µ —Ä–∞—Å—Å–ª–∞–±–ª—è–π—Å—è, –∫–æ—Ç—ë–Ω–æ–∫!"

            # NEW: –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞–Ω–∏–µ –æ—Ç Sylus, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
            if are_encourage_notifications_enabled(user_id):
                encourage_message = random.choice(ENCOURAGE_MESSAGES)
                message += f"\n\n{encourage_message}\n‚Äî –°–∞–π–ª—É—Å –ö. –£–∏–ª—Å–æ–Ω, –≥–ª–∞–≤–∞ Onychinus üéå"

            if send_message_with_retry(bot, user_id, message):
                logger.info(f"–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id} –≤ {current_time_msk.strftime('%Y-%m-%d %H:%M:%S %Z')}")
            else:
                logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ send_daily_schedule: {e}", exc_info=True)
        send_error_notification("–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ", str(e))
